
<!DOCTYPE html>

<html class="no-js" lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Daniel Joven" name="author"/>
<link href="https://zentyal-aws.projects.djoven.es/zentyal-certificates/" rel="canonical"/>
<link href="../zentyal-configuration/" rel="prev"/>
<link href="../zentyal-hardening/" rel="next"/>
<link href="../assets/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-9.1.6" name="generator"/>
<title>Certificates - Zentyal &amp; AWS</title>
<link href="../assets/stylesheets/main.ded33207.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.a0c5b2b5.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="red" data-md-color-primary="" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#certificados">
          Saltar a contenido
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Cabecera" class="md-header__inner md-grid">
<a aria-label="Zentyal &amp; AWS" class="md-header__button md-logo" data-md-component="logo" href=".." title="Zentyal &amp; AWS">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Zentyal &amp; AWS
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Certificates
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
</form>
<div class="md-header__option">
<div class="md-select">
<button aria-label="Seleccionar idioma" class="md-header__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"></path></svg>
</button>
<div class="md-select__inner">
<ul class="md-select__list">
<li class="md-select__item">
<a class="md-select__link" href="./" hreflang="es">
                    Spanish
                  </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="../en/zentyal-certificates/" hreflang="en">
                    English
                  </a>
</li>
</ul>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Búsqueda" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Búsqueda" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Buscar" class="md-search__options">
<button aria-label="Limpiar" class="md-search__icon md-icon" tabindex="-1" title="Limpiar" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/djoven89/zentyal-aws" title="Ir al repositorio">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Pestañas" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="..">
      Home
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../aws-configuration/">
      AWS
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../zentyal-installation/">
      Install
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../zentyal-configuration/">
      Configuration
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="./">
      Certificates
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../zentyal-hardening/">
      Hardening
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../backup/">
      Backup
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../monitoring/">
      Monitoring
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../maintenance/">
      Maintenance
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../recovery/">
      Recovery
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../zentyal-bug-fixing/">
      Bug fixing
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../about/">
      About me
    </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navegación" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Zentyal &amp; AWS" class="md-nav__button md-logo" data-md-component="logo" href=".." title="Zentyal &amp; AWS">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    Zentyal &amp; AWS
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/djoven89/zentyal-aws" title="Ir al repositorio">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Home
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aws-configuration/">
        AWS
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../zentyal-installation/">
        Install
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../zentyal-configuration/">
        Configuration
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Certificates
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Certificates
      </a>
<nav aria-label="Tabla de contenidos" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#webadmin">
    Webadmin
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mail-y-webmail">
    Mail y Webmail
  </a>
<nav aria-label="Mail y Webmail" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#webmail">
    Webmail
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mail">
    Mail
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../zentyal-hardening/">
        Hardening
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../backup/">
        Backup
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../monitoring/">
        Monitoring
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../maintenance/">
        Maintenance
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../recovery/">
        Recovery
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../zentyal-bug-fixing/">
        Bug fixing
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../about/">
        About me
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<nav class="md-tags">
<span class="md-tag">Zentyal</span>
</nav>
<h1 id="certificados">Certificados<a class="headerlink" href="#certificados" title="Permanent link">¶</a></h1>
<p>Zentyal por defecto uso certificados auto firmados para sus módulos, incluyendo el uso del módulo de CA. Esta situación provoca que se muestren warning como por ejemplo, usando clientes de correo o al acceder al webadmin o webmail. Es por esto que en esta página se mostrará como generar certificados reconocidos emitidos por Let's Encrypt.</p>
<p>Las acciones que realizaré para el proyecto serán:</p>
<ol>
<li>Emitiré 2 certificados, teniendo uno de ellos dos subdominios:<ul>
<li>Módulo de webadmin: <code>arthas.icecrown.es</code></li>
<li>Módulo de correo y webmail: <code>mail.icecrown.es</code> y <code>webmail.icecrown.es</code></li>
</ul>
</li>
<li>Usaré el <a href="https://letsencrypt.org/docs/challenge-types/">challenge</a> de tipo HTTP.</li>
<li>Usaré la cuenta de correo <code>it.infra@icecrown.es</code> como cuenta de correo para la recepción de notificaciones por parte de Let's Encrypt.</li>
</ol>
<p>A continuación se indican las acciones a realizar antes de proceder a la generación de los certificados.</p>
<ol>
<li>
<p>Instalamos los paquetes necesarios para la generación de los certificados:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>certbot<span class="w"> </span>python3-certbot-apache
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Creamos una regla temporal en el firewall de Zentyal como en el security group de AWS que permita el protocolo HTTP para que el certificado pueda expedirse:</p>
<p>Para el firewall de Zentyal:
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/zentyal/certificates_firewall-zentyal.png"><img alt="Firewall rule in Zentyal" src="../assets/zentyal/certificates_firewall-zentyal.png" title="Firewall rule in Zentyal"/></a></p>
<p>Para el security group de AWS:
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/zentyal/certificates_firewall-aws.png"><img alt="Firewall rule in AWS" src="../assets/zentyal/certificates_firewall-aws.png" title="Firewall rule in AWS"/></a></p>
<div class="admonition nota">
<p class="admonition-title">Nota</p>
<p>Podremos eliminar esta regla una vez hayamos emitidos los certificados o la mantendremos para evitar tener que volver a establecerla cuando toque la renovación de los certificados.</p>
</div>
</li>
<li>
<p>Creamos la cuenta de correo que recibirá las notificaciones:</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/zentyal/certificates-email_account.png"><img alt="Mail account for notifications" src="../assets/zentyal/certificates-email_account.png" title="Mail account for notifications"/></a></p>
</li>
<li>
<p>Comprobaremos que desde el exterior podemos resolver los subdominios en cuestión:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>dig<span class="w"> </span>arthas.icecrown.es<span class="w"> </span>@8.8.8.8
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>dig<span class="w"> </span>mail.icecrown.es<span class="w"> </span>@8.8.8.8
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>dig<span class="w"> </span>webmail.icecrown.es<span class="w"> </span>@8.8.8.8
</code></pre></div></td></tr></table></div>
<p>El resultado que obtengo en mi caso es:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span>
<span class="normal"><a href="#__codelineno-2-21">21</a></span>
<span class="normal"><a href="#__codelineno-2-22">22</a></span>
<span class="normal"><a href="#__codelineno-2-23">23</a></span>
<span class="normal"><a href="#__codelineno-2-24">24</a></span>
<span class="normal"><a href="#__codelineno-2-25">25</a></span>
<span class="normal"><a href="#__codelineno-2-26">26</a></span>
<span class="normal"><a href="#__codelineno-2-27">27</a></span>
<span class="normal"><a href="#__codelineno-2-28">28</a></span>
<span class="normal"><a href="#__codelineno-2-29">29</a></span>
<span class="normal"><a href="#__codelineno-2-30">30</a></span>
<span class="normal"><a href="#__codelineno-2-31">31</a></span>
<span class="normal"><a href="#__codelineno-2-32">32</a></span>
<span class="normal"><a href="#__codelineno-2-33">33</a></span>
<span class="normal"><a href="#__codelineno-2-34">34</a></span>
<span class="normal"><a href="#__codelineno-2-35">35</a></span>
<span class="normal"><a href="#__codelineno-2-36">36</a></span>
<span class="normal"><a href="#__codelineno-2-37">37</a></span>
<span class="normal"><a href="#__codelineno-2-38">38</a></span>
<span class="normal"><a href="#__codelineno-2-39">39</a></span>
<span class="normal"><a href="#__codelineno-2-40">40</a></span>
<span class="normal"><a href="#__codelineno-2-41">41</a></span>
<span class="normal"><a href="#__codelineno-2-42">42</a></span>
<span class="normal"><a href="#__codelineno-2-43">43</a></span>
<span class="normal"><a href="#__codelineno-2-44">44</a></span>
<span class="normal"><a href="#__codelineno-2-45">45</a></span>
<span class="normal"><a href="#__codelineno-2-46">46</a></span>
<span class="normal"><a href="#__codelineno-2-47">47</a></span>
<span class="normal"><a href="#__codelineno-2-48">48</a></span>
<span class="normal"><a href="#__codelineno-2-49">49</a></span>
<span class="normal"><a href="#__codelineno-2-50">50</a></span>
<span class="normal"><a href="#__codelineno-2-51">51</a></span>
<span class="normal"><a href="#__codelineno-2-52">52</a></span>
<span class="normal"><a href="#__codelineno-2-53">53</a></span>
<span class="normal"><a href="#__codelineno-2-54">54</a></span>
<span class="normal"><a href="#__codelineno-2-55">55</a></span>
<span class="normal"><a href="#__codelineno-2-56">56</a></span>
<span class="normal"><a href="#__codelineno-2-57">57</a></span>
<span class="normal"><a href="#__codelineno-2-58">58</a></span>
<span class="normal"><a href="#__codelineno-2-59">59</a></span>
<span class="normal"><a href="#__codelineno-2-60">60</a></span>
<span class="normal"><a href="#__codelineno-2-61">61</a></span>
<span class="normal"><a href="#__codelineno-2-62">62</a></span>
<span class="normal"><a href="#__codelineno-2-63">63</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>## Webadmin
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; arthas.icecrown.es @8.8.8.8
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>;; global options: +cmd
<a id="__codelineno-2-4" name="__codelineno-2-4"></a>;; Got answer:
<a id="__codelineno-2-5" name="__codelineno-2-5"></a>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 25953
<a id="__codelineno-2-6" name="__codelineno-2-6"></a>;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1
<a id="__codelineno-2-7" name="__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a>;; OPT PSEUDOSECTION:
<a id="__codelineno-2-9" name="__codelineno-2-9"></a>; EDNS: version: 0, flags:; udp: 512
<a id="__codelineno-2-10" name="__codelineno-2-10"></a>;; QUESTION SECTION:
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>;arthas.icecrown.es.        IN  A
<a id="__codelineno-2-12" name="__codelineno-2-12"></a>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a>;; ANSWER SECTION:
<a id="__codelineno-2-14" name="__codelineno-2-14"></a>arthas.icecrown.es. 120 IN  A   15.237.168.75
<a id="__codelineno-2-15" name="__codelineno-2-15"></a>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a>;; Query time: 20 msec
<a id="__codelineno-2-17" name="__codelineno-2-17"></a>;; SERVER: 8.8.8.8#53(8.8.8.8)
<a id="__codelineno-2-18" name="__codelineno-2-18"></a>;; WHEN: Sat Feb 18 22:20:39 CET 2023
<a id="__codelineno-2-19" name="__codelineno-2-19"></a>;; MSG SIZE  rcvd: 63
<a id="__codelineno-2-20" name="__codelineno-2-20"></a>
<a id="__codelineno-2-21" name="__codelineno-2-21"></a>
<a id="__codelineno-2-22" name="__codelineno-2-22"></a>## Mail
<a id="__codelineno-2-23" name="__codelineno-2-23"></a>; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; mail.icecrown.es @8.8.8.8
<a id="__codelineno-2-24" name="__codelineno-2-24"></a>;; global options: +cmd
<a id="__codelineno-2-25" name="__codelineno-2-25"></a>;; Got answer:
<a id="__codelineno-2-26" name="__codelineno-2-26"></a>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 37980
<a id="__codelineno-2-27" name="__codelineno-2-27"></a>;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1
<a id="__codelineno-2-28" name="__codelineno-2-28"></a>
<a id="__codelineno-2-29" name="__codelineno-2-29"></a>;; OPT PSEUDOSECTION:
<a id="__codelineno-2-30" name="__codelineno-2-30"></a>; EDNS: version: 0, flags:; udp: 512
<a id="__codelineno-2-31" name="__codelineno-2-31"></a>;; QUESTION SECTION:
<a id="__codelineno-2-32" name="__codelineno-2-32"></a>;mail.icecrown.es.      IN  A
<a id="__codelineno-2-33" name="__codelineno-2-33"></a>
<a id="__codelineno-2-34" name="__codelineno-2-34"></a>;; ANSWER SECTION:
<a id="__codelineno-2-35" name="__codelineno-2-35"></a>mail.icecrown.es.   300 IN  CNAME   arthas.icecrown.es.
<a id="__codelineno-2-36" name="__codelineno-2-36"></a>arthas.icecrown.es. 120 IN  A   15.237.168.75
<a id="__codelineno-2-37" name="__codelineno-2-37"></a>
<a id="__codelineno-2-38" name="__codelineno-2-38"></a>;; Query time: 16 msec
<a id="__codelineno-2-39" name="__codelineno-2-39"></a>;; SERVER: 8.8.8.8#53(8.8.8.8)
<a id="__codelineno-2-40" name="__codelineno-2-40"></a>;; WHEN: Sat Feb 18 22:20:39 CET 2023
<a id="__codelineno-2-41" name="__codelineno-2-41"></a>;; MSG SIZE  rcvd: 82
<a id="__codelineno-2-42" name="__codelineno-2-42"></a>
<a id="__codelineno-2-43" name="__codelineno-2-43"></a>
<a id="__codelineno-2-44" name="__codelineno-2-44"></a>## Webmail
<a id="__codelineno-2-45" name="__codelineno-2-45"></a>; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; webmail.icecrown.es @8.8.8.8
<a id="__codelineno-2-46" name="__codelineno-2-46"></a>;; global options: +cmd
<a id="__codelineno-2-47" name="__codelineno-2-47"></a>;; Got answer:
<a id="__codelineno-2-48" name="__codelineno-2-48"></a>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 45405
<a id="__codelineno-2-49" name="__codelineno-2-49"></a>;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1
<a id="__codelineno-2-50" name="__codelineno-2-50"></a>
<a id="__codelineno-2-51" name="__codelineno-2-51"></a>;; OPT PSEUDOSECTION:
<a id="__codelineno-2-52" name="__codelineno-2-52"></a>; EDNS: version: 0, flags:; udp: 512
<a id="__codelineno-2-53" name="__codelineno-2-53"></a>;; QUESTION SECTION:
<a id="__codelineno-2-54" name="__codelineno-2-54"></a>;webmail.icecrown.es.       IN  A
<a id="__codelineno-2-55" name="__codelineno-2-55"></a>
<a id="__codelineno-2-56" name="__codelineno-2-56"></a>;; ANSWER SECTION:
<a id="__codelineno-2-57" name="__codelineno-2-57"></a>webmail.icecrown.es.    300 IN  CNAME   arthas.icecrown.es.
<a id="__codelineno-2-58" name="__codelineno-2-58"></a>arthas.icecrown.es. 120 IN  A   15.237.168.75
<a id="__codelineno-2-59" name="__codelineno-2-59"></a>
<a id="__codelineno-2-60" name="__codelineno-2-60"></a>;; Query time: 28 msec
<a id="__codelineno-2-61" name="__codelineno-2-61"></a>;; SERVER: 8.8.8.8#53(8.8.8.8)
<a id="__codelineno-2-62" name="__codelineno-2-62"></a>;; WHEN: Sat Feb 18 22:20:40 CET 2023
<a id="__codelineno-2-63" name="__codelineno-2-63"></a>;; MSG SIZE  rcvd: 85
</code></pre></div></td></tr></table></div>
</li>
</ol>
<h2 id="webadmin">Webadmin<a class="headerlink" href="#webadmin" title="Permanent link">¶</a></h2>
<p>Para generar el certificado para el <strong>Webadmin (panel de administración)</strong> usaremos el paquete <code>python3-certbot-apache</code> en lugar de <code>python3-certbot-nginx</code> debido a que Zentyal ejecuta Nginx de forma personalizada, lo que provoca errores a la hora de generar certificados.</p>
<ol>
<li>
<p>Generaremos el certificado:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span>
<span class="normal"><a href="#__codelineno-3-5">5</a></span>
<span class="normal"><a href="#__codelineno-3-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>sudo<span class="w"> </span>certbot<span class="w"> </span>certonly<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">    </span>--apache<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">    </span>--preferred-challenges<span class="w"> </span>http<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">    </span>-m<span class="w"> </span>it.infra@icecrown.es<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">    </span>--agree-tos<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">    </span>-d<span class="w"> </span>arthas.icecrown.es
</code></pre></div></td></tr></table></div>
<p>Un ejemplo del resultado:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>Saving debug log to /var/log/letsencrypt/letsencrypt.log
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>Plugins selected: Authenticator apache, Installer apache
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>Obtaining a new certificate
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>Performing the following challenges:
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>http-01 challenge for arthas.icecrown.es
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>Enabled Apache rewrite module
<a id="__codelineno-4-7" name="__codelineno-4-7"></a>Waiting for verification...
<a id="__codelineno-4-8" name="__codelineno-4-8"></a>Cleaning up challenges
<a id="__codelineno-4-9" name="__codelineno-4-9"></a>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a>IMPORTANT NOTES:
<a id="__codelineno-4-11" name="__codelineno-4-11"></a>- Congratulations! Your certificate and chain have been saved at:
<a id="__codelineno-4-12" name="__codelineno-4-12"></a>/etc/letsencrypt/live/arthas.icecrown.es/fullchain.pem
<a id="__codelineno-4-13" name="__codelineno-4-13"></a>Your key file has been saved at:
<a id="__codelineno-4-14" name="__codelineno-4-14"></a>/etc/letsencrypt/live/arthas.icecrown.es/privkey.pem
<a id="__codelineno-4-15" name="__codelineno-4-15"></a>Your cert will expire on 2023-05-19. To obtain a new or tweaked
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>version of this certificate in the future, simply run certbot
<a id="__codelineno-4-17" name="__codelineno-4-17"></a>again. To non-interactively renew *all* of your certificates, run
<a id="__codelineno-4-18" name="__codelineno-4-18"></a>"certbot renew"
<a id="__codelineno-4-19" name="__codelineno-4-19"></a>- If you like Certbot, please consider supporting our work by:
<a id="__codelineno-4-20" name="__codelineno-4-20"></a>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a>Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate
<a id="__codelineno-4-22" name="__codelineno-4-22"></a>Donating to EFF:                    https://eff.org/donate-le
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Con el certificado generado, tendremos que modificar la plantilla de configuración (<a href="https://doc.zentyal.org/en/appendix-c.html#stubs">stub</a>) del módulo, para que dicho cambio sea persistente ante futuras actualizaciones del módulo por parte de Zentyal. Para ello, crearemos los directorios necesarios:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>sudo<span class="w"> </span>mkdir<span class="w"> </span>-vp<span class="w"> </span>/etc/zentyal/stubs/core
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Copiamos la plantilla a modificar:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>sudo<span class="w"> </span>cp<span class="w"> </span>-v<span class="w"> </span>/usr/share/zentyal/stubs/core/nginx.conf.mas<span class="w"> </span>/etc/zentyal/stubs/core/
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Modificamos en la plantilla recién copiada los siguientes parámetros de configuración:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span>
<span class="normal"><a href="#__codelineno-7-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>## Custom certificates issued on 18-02-2023 by Daniel
<a id="__codelineno-7-2" name="__codelineno-7-2"></a># ssl_certificate &lt;% $zentyalconfdir %&gt;ssl/ssl.pem;
<a id="__codelineno-7-3" name="__codelineno-7-3"></a># ssl_certificate_key &lt;% $zentyalconfdir %&gt;ssl/ssl.pem;
<a id="__codelineno-7-4" name="__codelineno-7-4"></a>ssl_certificate  /etc/letsencrypt/live/arthas.icecrown.es/fullchain.pem;
<a id="__codelineno-7-5" name="__codelineno-7-5"></a>ssl_certificate_key /etc/letsencrypt/live/arthas.icecrown.es/privkey.pem;
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Opcionalmente, también modificaré los siguientes parámetros de configuración, cuyo valores ha han sido generados desde <a href="https://ssl-config.mozilla.org/#server=nginx&amp;version=1.17.7&amp;config=intermediate&amp;openssl=1.1.1k&amp;hsts=false&amp;ocsp=false&amp;guideline=5.6">esta</a> página web.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span>
<span class="normal"><a href="#__codelineno-8-7">7</a></span>
<span class="normal"><a href="#__codelineno-8-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>## Custom configuration applied on 18-02-2023 by Daniel
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>## https://ssl-config.mozilla.org/#server=nginx&amp;version=1.17.7&amp;config=intermediate&amp;openssl=1.1.1k&amp;hsts=false&amp;ocsp=false&amp;guideline=5.6
<a id="__codelineno-8-3" name="__codelineno-8-3"></a># ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
<a id="__codelineno-8-4" name="__codelineno-8-4"></a># ssl_ciphers "ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!3DES:!MD5:!PSK";
<a id="__codelineno-8-5" name="__codelineno-8-5"></a># ssl_prefer_server_ciphers on;
<a id="__codelineno-8-6" name="__codelineno-8-6"></a>ssl_protocols TLSv1.2 TLSv1.3;
<a id="__codelineno-8-7" name="__codelineno-8-7"></a>ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;
<a id="__codelineno-8-8" name="__codelineno-8-8"></a>ssl_prefer_server_ciphers off;
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Paramos el módulo del Webadmin, recargaremos Systemd y volvemos a iniciarlo para aplicar estos cambios:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a>sudo<span class="w"> </span>zs<span class="w"> </span>webadmin<span class="w"> </span>stop
<a id="__codelineno-9-2" name="__codelineno-9-2"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>daemon-reload
<a id="__codelineno-9-3" name="__codelineno-9-3"></a>sudo<span class="w"> </span>zs<span class="w"> </span>webadmin<span class="w"> </span>restart
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Finalmente, accedemos al webadmin para confirmar que el certificado es correcto:</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/zentyal/certificate-webadmin_login.png"><img alt="Webadmin certificate verification" src="../assets/zentyal/certificate-webadmin_login.png" title="Webadmin certificate verification"/></a></p>
</li>
</ol>
<h2 id="mail-y-webmail">Mail y Webmail<a class="headerlink" href="#mail-y-webmail" title="Permanent link">¶</a></h2>
<p>Para los módulos <strong>Mail</strong> y <strong>Webmail</strong> usaré el mismo certificado, es decir, el certificado será emitido con 2 subdominios en lugar de 1.</p>
<p>Generaremos el certificado:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span>
<span class="normal"><a href="#__codelineno-10-5">5</a></span>
<span class="normal"><a href="#__codelineno-10-6">6</a></span>
<span class="normal"><a href="#__codelineno-10-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a>sudo<span class="w"> </span>certbot<span class="w"> </span>certonly<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="w">    </span>--apache<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="w">    </span>--preferred-challenges<span class="w"> </span>http<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="w">    </span>-m<span class="w"> </span>it.infra@icecrown.es<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="w">    </span>--agree-tos<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="w">    </span>-d<span class="w"> </span>mail.icecrown.es<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="w">    </span>-d<span class="w"> </span>webmail.icecrown.es
</code></pre></div></td></tr></table></div>
<p>Un ejemplo del resultado:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span>
<span class="normal"><a href="#__codelineno-11-16">16</a></span>
<span class="normal"><a href="#__codelineno-11-17">17</a></span>
<span class="normal"><a href="#__codelineno-11-18">18</a></span>
<span class="normal"><a href="#__codelineno-11-19">19</a></span>
<span class="normal"><a href="#__codelineno-11-20">20</a></span>
<span class="normal"><a href="#__codelineno-11-21">21</a></span>
<span class="normal"><a href="#__codelineno-11-22">22</a></span>
<span class="normal"><a href="#__codelineno-11-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a>Saving debug log to /var/log/letsencrypt/letsencrypt.log
<a id="__codelineno-11-2" name="__codelineno-11-2"></a>Plugins selected: Authenticator apache, Installer apache
<a id="__codelineno-11-3" name="__codelineno-11-3"></a>Obtaining a new certificate
<a id="__codelineno-11-4" name="__codelineno-11-4"></a>Performing the following challenges:
<a id="__codelineno-11-5" name="__codelineno-11-5"></a>http-01 challenge for mail.icecrown.es
<a id="__codelineno-11-6" name="__codelineno-11-6"></a>http-01 challenge for webmail.icecrown.es
<a id="__codelineno-11-7" name="__codelineno-11-7"></a>Enabled Apache rewrite module
<a id="__codelineno-11-8" name="__codelineno-11-8"></a>Waiting for verification...
<a id="__codelineno-11-9" name="__codelineno-11-9"></a>Cleaning up challenges
<a id="__codelineno-11-10" name="__codelineno-11-10"></a>
<a id="__codelineno-11-11" name="__codelineno-11-11"></a>IMPORTANT NOTES:
<a id="__codelineno-11-12" name="__codelineno-11-12"></a>- Congratulations! Your certificate and chain have been saved at:
<a id="__codelineno-11-13" name="__codelineno-11-13"></a>/etc/letsencrypt/live/mail.icecrown.es/fullchain.pem
<a id="__codelineno-11-14" name="__codelineno-11-14"></a>Your key file has been saved at:
<a id="__codelineno-11-15" name="__codelineno-11-15"></a>/etc/letsencrypt/live/mail.icecrown.es/privkey.pem
<a id="__codelineno-11-16" name="__codelineno-11-16"></a>Your cert will expire on 2023-05-19. To obtain a new or tweaked
<a id="__codelineno-11-17" name="__codelineno-11-17"></a>version of this certificate in the future, simply run certbot
<a id="__codelineno-11-18" name="__codelineno-11-18"></a>again. To non-interactively renew *all* of your certificates, run
<a id="__codelineno-11-19" name="__codelineno-11-19"></a>"certbot renew"
<a id="__codelineno-11-20" name="__codelineno-11-20"></a>- If you like Certbot, please consider supporting our work by:
<a id="__codelineno-11-21" name="__codelineno-11-21"></a>
<a id="__codelineno-11-22" name="__codelineno-11-22"></a>Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate
<a id="__codelineno-11-23" name="__codelineno-11-23"></a>Donating to EFF:                    https://eff.org/donate-le
</code></pre></div></td></tr></table></div>
<p>Con el certificado correctamente generado, procederé a configurar los ambos módulos para que hagan uso de el.</p>
<h3 id="webmail">Webmail<a class="headerlink" href="#webmail" title="Permanent link">¶</a></h3>
<p>Para este módulo, no será necesario editar un <a href="https://doc.zentyal.org/en/appendix-c.html#stubs">stub</a>, sino que simplemente habrá que modificar el archivo de configuración de Apache.</p>
<ol>
<li>
<p>Modificamos el archivo de configuración <code>/etc/apache2/sites-available/default-ssl.conf</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a>## Custom certificates issued on 18-02-2023 by Daniel
<a id="__codelineno-12-2" name="__codelineno-12-2"></a># SSLCertificateFile    /etc/ssl/certs/ssl-cert-snakeoil.pem
<a id="__codelineno-12-3" name="__codelineno-12-3"></a># SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key
<a id="__codelineno-12-4" name="__codelineno-12-4"></a>SSLCertificateFile  /etc/letsencrypt/live/mail.icecrown.es/fullchain.pem
<a id="__codelineno-12-5" name="__codelineno-12-5"></a>SSLCertificateKeyFile /etc/letsencrypt/live/mail.icecrown.es/privkey.pem
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Opcionalmente, también añadiré los siguientes parámetros de configuración al final del archivo de configuración. Los valores de los parámetros han sido generados desde <a href="https://ssl-config.mozilla.org/#server=apache&amp;version=2.4.41&amp;config=intermediate&amp;openssl=1.1.1k&amp;hsts=false&amp;ocsp=false&amp;guideline=5.6">esta</a> página web.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span>
<span class="normal"><a href="#__codelineno-13-4">4</a></span>
<span class="normal"><a href="#__codelineno-13-5">5</a></span>
<span class="normal"><a href="#__codelineno-13-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a>## Custom configuration applied on 18-02-2023 by Daniel
<a id="__codelineno-13-2" name="__codelineno-13-2"></a>## https://ssl-config.mozilla.org/#server=apache&amp;version=2.4.41&amp;config=intermediate&amp;openssl=1.1.1k&amp;hsts=false&amp;ocsp=false&amp;guideline=5.6
<a id="__codelineno-13-3" name="__codelineno-13-3"></a>SSLProtocol             all -SSLv3 -TLSv1 -TLSv1.1
<a id="__codelineno-13-4" name="__codelineno-13-4"></a>SSLCipherSuite          ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384
<a id="__codelineno-13-5" name="__codelineno-13-5"></a>SSLHonorCipherOrder     off
<a id="__codelineno-13-6" name="__codelineno-13-6"></a>SSLSessionTickets       off
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Reiniciamos el servicio de Apache:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>apache2
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Finalmente, accedemos al webadmin para confirmar que el certificado es correcto:</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/zentyal/certificate-webmail.png"><img alt="Webmail certificate verification" src="../assets/zentyal/certificate-webmail.png" title="Webmail certificate verification"/></a></p>
</li>
</ol>
<h3 id="mail">Mail<a class="headerlink" href="#mail" title="Permanent link">¶</a></h3>
<p>Para este módulo habrá que modificar dos plantillas (<a href="https://doc.zentyal.org/en/appendix-c.html#stubs">stubs</a>), una para el servicio SMTP (Postfix) y otra para IMAP/POP3 (Dovecot):</p>
<ul>
<li>main.cf.mas</li>
<li>dovecot.conf.mas</li>
</ul>
<p>Las acciones a realizar son:</p>
<ol>
<li>
<p>Creamos el directorio donde ubicaremos las plantillas:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a>sudo<span class="w"> </span>mkdir<span class="w"> </span>-vp<span class="w"> </span>/etc/zentyal/stubs/mail
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Copiaremos las plantillas a modificar:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a>sudo<span class="w"> </span>sudo<span class="w"> </span>cp<span class="w"> </span>-v<span class="w"> </span>/usr/share/zentyal/stubs/mail/<span class="o">{</span>main.cf,dovecot.conf<span class="o">}</span>.mas<span class="w"> </span>/etc/zentyal/stubs/mail/
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Modificamos la plantilla <code>main.cf.mas</code> para el servicio Postfix (SMTP):</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span>
<span class="normal"><a href="#__codelineno-17-2">2</a></span>
<span class="normal"><a href="#__codelineno-17-3">3</a></span>
<span class="normal"><a href="#__codelineno-17-4">4</a></span>
<span class="normal"><a href="#__codelineno-17-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a>## Custom certificates issued on 18-02-2023 by Daniel
<a id="__codelineno-17-2" name="__codelineno-17-2"></a># smtpd_tls_key_file  = &lt;% $keyFile  %&gt;
<a id="__codelineno-17-3" name="__codelineno-17-3"></a># smtpd_tls_cert_file = &lt;% $certFile %&gt;
<a id="__codelineno-17-4" name="__codelineno-17-4"></a>smtpd_tls_key_file  = /etc/letsencrypt/live/mail.icecrown.es/privkey.pem
<a id="__codelineno-17-5" name="__codelineno-17-5"></a>smtpd_tls_cert_file = /etc/letsencrypt/live/mail.icecrown.es/fullchain.pem
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Modificamos la otra plantilla <code>dovecot.conf.mas</code> para el servicio Dovecot (IMAP/POP3):</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span>
<span class="normal"><a href="#__codelineno-18-4">4</a></span>
<span class="normal"><a href="#__codelineno-18-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a>## Custom certificates issued on 18-02-2023 by Daniel
<a id="__codelineno-18-2" name="__codelineno-18-2"></a># ssl_cert =&lt;/etc/dovecot/private/dovecot.pem
<a id="__codelineno-18-3" name="__codelineno-18-3"></a># ssl_key =&lt;/etc/dovecot/private/dovecot.pem
<a id="__codelineno-18-4" name="__codelineno-18-4"></a>ssl_key  =&lt;/etc/letsencrypt/live/mail.icecrown.es/privkey.pem
<a id="__codelineno-18-5" name="__codelineno-18-5"></a>ssl_cert =&lt;/etc/letsencrypt/live/mail.icecrown.es/fullchain.pem
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Reiniciamos el módulo de correo para que se apliquen los cambios:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a>sudo<span class="w"> </span>zs<span class="w"> </span>mail<span class="w"> </span>restart
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Finalmente, confirmamos que ambos servicios están usando correctamente el nuevo certificado. Para realizar dicha acción, podremos usar cliente de correo como Thunderbird o el comando <code>openssl</code> como será mi caso:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span>
<span class="normal"><a href="#__codelineno-20-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-starttls<span class="w"> </span>smtp<span class="w"> </span>-showcerts<span class="w"> </span>-connect<span class="w"> </span>mail.icecrown.es:465<span class="w"> </span>-servername<span class="w"> </span>mail.icecrown.es
<a id="__codelineno-20-2" name="__codelineno-20-2"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-showcerts<span class="w"> </span>-connect<span class="w"> </span>mail.icecrown.es:993<span class="w"> </span>-servername<span class="w"> </span>mail.icecrown.es
</code></pre></div></td></tr></table></div>
<p>El resultado obtenido en mi caso ha sido:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span>
<span class="normal"><a href="#__codelineno-21-13">13</a></span>
<span class="normal"><a href="#__codelineno-21-14">14</a></span>
<span class="normal"><a href="#__codelineno-21-15">15</a></span>
<span class="normal"><a href="#__codelineno-21-16">16</a></span>
<span class="normal"><a href="#__codelineno-21-17">17</a></span>
<span class="normal"><a href="#__codelineno-21-18">18</a></span>
<span class="normal"><a href="#__codelineno-21-19">19</a></span>
<span class="normal"><a href="#__codelineno-21-20">20</a></span>
<span class="normal"><a href="#__codelineno-21-21">21</a></span>
<span class="normal"><a href="#__codelineno-21-22">22</a></span>
<span class="normal"><a href="#__codelineno-21-23">23</a></span>
<span class="normal"><a href="#__codelineno-21-24">24</a></span>
<span class="normal"><a href="#__codelineno-21-25">25</a></span>
<span class="normal"><a href="#__codelineno-21-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a>## Para SMTP
<a id="__codelineno-21-2" name="__codelineno-21-2"></a>CONNECTED(00000003)
<a id="__codelineno-21-3" name="__codelineno-21-3"></a>depth=2 C = US, O = Internet Security Research Group, CN = ISRG Root X1
<a id="__codelineno-21-4" name="__codelineno-21-4"></a>verify return:1
<a id="__codelineno-21-5" name="__codelineno-21-5"></a>depth=1 C = US, O = Let's Encrypt, CN = R3
<a id="__codelineno-21-6" name="__codelineno-21-6"></a>verify return:1
<a id="__codelineno-21-7" name="__codelineno-21-7"></a>depth=0 CN = mail.icecrown.es
<a id="__codelineno-21-8" name="__codelineno-21-8"></a>verify return:1
<a id="__codelineno-21-9" name="__codelineno-21-9"></a>---
<a id="__codelineno-21-10" name="__codelineno-21-10"></a>Certificate chain
<a id="__codelineno-21-11" name="__codelineno-21-11"></a>0 s:CN = mail.icecrown.es
<a id="__codelineno-21-12" name="__codelineno-21-12"></a>i:C = US, O = Let's Encrypt, CN = R3
<a id="__codelineno-21-13" name="__codelineno-21-13"></a>
<a id="__codelineno-21-14" name="__codelineno-21-14"></a>
<a id="__codelineno-21-15" name="__codelineno-21-15"></a>## Para IMAP
<a id="__codelineno-21-16" name="__codelineno-21-16"></a>CONNECTED(00000003)
<a id="__codelineno-21-17" name="__codelineno-21-17"></a>depth=2 C = US, O = Internet Security Research Group, CN = ISRG Root X1
<a id="__codelineno-21-18" name="__codelineno-21-18"></a>verify return:1
<a id="__codelineno-21-19" name="__codelineno-21-19"></a>depth=1 C = US, O = Let's Encrypt, CN = R3
<a id="__codelineno-21-20" name="__codelineno-21-20"></a>verify return:1
<a id="__codelineno-21-21" name="__codelineno-21-21"></a>depth=0 CN = mail.icecrown.es
<a id="__codelineno-21-22" name="__codelineno-21-22"></a>verify return:1
<a id="__codelineno-21-23" name="__codelineno-21-23"></a>---
<a id="__codelineno-21-24" name="__codelineno-21-24"></a>Certificate chain
<a id="__codelineno-21-25" name="__codelineno-21-25"></a>0 s:CN = mail.icecrown.es
<a id="__codelineno-21-26" name="__codelineno-21-26"></a>i:C = US, O = Let's Encrypt, CN = R3
</code></pre></div></td></tr></table></div>
</li>
</ol>
<hr/>
<div class="md-source-file">
<small>
    
      Última actualización:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">12 de abril de 2023</span>
<br/>
        Creado:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">12 de abril de 2023</span>
</small>
</div>
</article>
</div>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            Volver al principio
          </button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.indexes", "toc.integrate", "content.code.copy", "content.code.annotate", "navigation.top"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
<script src="../assets/javascripts/bundle.51198bba.min.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>